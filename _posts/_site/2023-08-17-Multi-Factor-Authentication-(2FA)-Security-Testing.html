<h1 id="introduction">Introduction</h1>
<p>Greetings, fellow security enthusiasts!</p>

<p>Imagine a lock that requires not just one, but two secret keys to open. That’s Multi-Factor Authentication (2FA) in a nutshell – an extra layer of defense that’s become a game-changer in keeping digital front doors locked against cyber intruders.</p>

<p>In this guide, we’re diving into the world of 2FA security. Think of it as a treasure map that leads us through uncharted territory, where we’ll uncover hidden vulnerabilities, test their strength, and equip ourselves with tools to ensure that 2FA is as solid as a fortress.</p>

<p>Whether you’re a seasoned pentester or just starting out on your bug-hunting adventure, join us as we unravel the secrets of Multi-Factor Authentication, one factor at a time!</p>
<h1 id="1-2fa-setup">1. 2FA Setup</h1>

<h2 id="2fa-secret-cannot-be-rotated-p4">2FA Secret Cannot be Rotated [P4]</h2>

<p>The 2FA secret is a cryptographic key that is shared between the user and the application. It is used to generate time-based one-time passwords (TOTPs) for authentication. Rotating the secret means changing this key periodically to enhance security. If the 2FA secret cannot be rotated, it means that once the secret is compromised, an attacker could potentially gain ongoing access to the account without the user’s knowledge, as there is no way for the user to change the secret.</p>

<h3 id="steps">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">Login</span> <span class="n">to</span> <span class="n">the</span> <span class="n">application</span> 
<span class="mf">2.</span> <span class="n">Setup</span> <span class="n">two</span> <span class="n">factor</span> <span class="n">authentication</span>
<span class="mf">3.</span> <span class="n">After</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">secret</span> <span class="ow">is</span> <span class="n">created</span><span class="p">,</span> <span class="n">observe</span> <span class="n">that</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">no</span> <span class="n">way</span> <span class="ow">in</span> <span class="n">which</span> <span class="n">the</span> <span class="n">secret</span> <span class="n">can</span> <span class="n">be</span> <span class="n">rotated</span>
</code></pre></div></div>

<blockquote>
  <p>This is a security weakness because if an attacker gains access to the 2FA secret, they could potentially use it to generate valid authentication codes and bypass the 2FA protection.</p>

</blockquote>

<p>References</p>

<ul>
  <li>https://bugcrowd.com/disclosures/0c8a87aa-f10f-4174-b6d8-56c365062910/2fa-secret-is-not-rotated</li>
  <li>https://zofixer.com/what-is-weak-2fa-implementation-2fa-secret-cannot-be-rotated-vulnerability/</li>
</ul>

<h2 id="2fa-secret-remains-obtainable-after-2fa-is-enabled-p4">2FA Secret Remains Obtainable After 2FA is Enabled [P4]</h2>

<p>The scenario “2FA Secret Remains Obtainable After 2FA is Enabled” in the Bugcrowd VRT refers to a vulnerability where, even after setting up two-factor authentication (2FA) for an account, the 2FA secret or key remains accessible to unauthorized individuals. This is a serious security flaw because the 2FA secret is a critical component of the authentication process, and if it is obtainable by attackers, it significantly weakens the overall security of the account.</p>

<h3 id="steps-1">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">If</span> <span class="n">Target</span> <span class="n">allows</span> <span class="n">using</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">authenticator</span> <span class="n">like</span> <span class="n">google</span> <span class="n">authenticator</span> <span class="ow">or</span> <span class="n">Microsoft</span> <span class="n">authenticator</span> <span class="n">etc</span><span class="p">...</span> 

<span class="n">Try</span> <span class="n">to</span> <span class="n">Find</span> <span class="n">a</span> <span class="n">path</span> <span class="n">that</span> <span class="n">leaks</span> <span class="n">QR</span> <span class="n">code</span> <span class="n">Or</span> <span class="n">the</span> <span class="n">secret</span> <span class="n">that</span> <span class="n">shows</span> <span class="n">when</span> <span class="n">enable</span> <span class="n">the</span> <span class="mi">2</span><span class="n">fa</span> <span class="n">authentication</span>

<span class="n">Analyze</span> <span class="n">JS</span> <span class="n">Files</span> <span class="ow">and</span> <span class="k">try</span> <span class="n">to</span> <span class="n">understand</span> <span class="n">how</span> <span class="n">the</span> <span class="n">target</span> <span class="n">generate</span> <span class="n">the</span> <span class="n">secret</span> 

<span class="n">test</span> <span class="k">if</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">secret</span> <span class="ow">is</span> <span class="n">still</span> <span class="n">retrievable</span> <span class="n">even</span> <span class="n">after</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">feature</span> <span class="n">has</span> <span class="n">been</span> <span class="n">activated</span> <span class="n">by</span> <span class="n">Replay</span> <span class="n">Attacks</span> <span class="ow">or</span> <span class="n">something</span>
</code></pre></div></div>

<h3 id="references">References</h3>

<ul>
  <li>https://bugcrowd.com/vulnerability-rating-taxonomy</li>
  <li>https://github.com/bugcrowd/vulnerability-rating-taxonomy/issues/203</li>
</ul>

<h1 id="2fa-setup-logic-flaw-varient">2FA Setup Logic Flaw [Varient]</h1>

<p>The “Flawed Authenticator Attachment in Web Application 2FA Setup” vulnerability exposes a critical flaw in the process of attaching an authenticator app for two-factor authentication (2FA) within a web application. This vulnerability allows an attacker to manipulate the verification step of attaching the authenticator, compromising the intended security benefits of the 2FA mechanism and leading to potential account compromise/damadge as there is no real authenticator attached to the account.</p>

<h3 id="steps-2">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="mf">1.</span> <span class="n">Login</span> <span class="ow">and</span> <span class="n">Initiate</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">Setup</span><span class="p">:</span> <span class="n">Log</span> <span class="ow">in</span> <span class="n">to</span> <span class="n">the</span> <span class="n">web</span> <span class="n">application</span> <span class="n">using</span> <span class="n">valid</span> <span class="n">credentials</span><span class="p">.</span> <span class="n">Navigate</span> <span class="n">to</span> <span class="n">the</span> <span class="n">section</span> <span class="k">for</span> <span class="n">setting</span> <span class="n">up</span> <span class="mi">2</span><span class="n">FA</span> <span class="ow">in</span> <span class="n">your</span> <span class="n">account</span> <span class="n">settings</span><span class="p">.</span>
<span class="mf">2.</span> <span class="n">Start</span> <span class="n">Authenticator</span> <span class="n">Attachment</span><span class="p">:</span> <span class="n">Begin</span> <span class="n">the</span> <span class="n">process</span> <span class="n">of</span> <span class="n">attaching</span> <span class="n">an</span> <span class="n">authenticator</span> <span class="n">app</span> <span class="k">for</span> <span class="mi">2</span><span class="n">FA</span><span class="p">.</span>
<span class="mf">3.</span> <span class="n">Provide</span> <span class="n">Incorrect</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">Code</span> <span class="ow">and</span> <span class="n">Capture</span> <span class="n">the</span> <span class="n">Request</span><span class="p">:</span> <span class="n">Enter</span> <span class="n">an</span> <span class="n">incorrect</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">code</span> <span class="k">from</span> <span class="n">the</span> <span class="n">authenticator</span> <span class="n">app</span><span class="p">.</span> <span class="n">Capture</span> <span class="n">the</span> <span class="n">request</span> <span class="n">made</span> <span class="n">by</span> <span class="n">the</span> <span class="n">application</span><span class="p">.</span>
<span class="mf">4.</span> <span class="n">Intercept</span> <span class="n">the</span> <span class="n">Response</span> <span class="ow">and</span> <span class="n">Manipulate</span> <span class="n">it</span> <span class="n">to</span> <span class="n">a</span> <span class="n">Successful</span> <span class="n">Response</span><span class="p">:</span> <span class="n">Intercept</span> <span class="n">the</span> <span class="n">response</span> <span class="n">sent</span> <span class="n">by</span> <span class="n">the</span> <span class="n">application</span> <span class="ow">and</span> <span class="n">modify</span> <span class="n">it</span> <span class="n">to</span> <span class="n">indicate</span> <span class="n">a</span> <span class="n">successful</span> <span class="n">verification</span><span class="p">,</span> <span class="n">even</span> <span class="n">though</span> <span class="n">the</span> <span class="n">provided</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">code</span> <span class="n">was</span> <span class="n">incorrect</span><span class="p">.</span>
<span class="n">Impact</span><span class="p">:</span> <span class="n">User</span> <span class="n">can</span><span class="sh">'</span><span class="s">t login anymore
</span></code></pre></div></div>

<h2 id="old-session-does-not-expire-after-setup-2fa-p4">Old session does not expire after setup 2FA [P4]</h2>

<p>Old sessions persist after enabling 2FA, letting attackers access accounts even with 2FA. This undermines security and could lead to unauthorized actions. Developers must invalidate old sessions upon 2FA activation for robust protection.</p>

<h3 id="steps-3">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">Login</span> <span class="n">to</span> <span class="n">the</span> <span class="n">application</span> <span class="ow">in</span> <span class="n">two</span> <span class="n">different</span> <span class="n">browsers</span> <span class="ow">and</span> <span class="n">enable</span> <span class="mi">2</span><span class="n">FA</span> <span class="k">from</span> <span class="mi">1</span><span class="n">st</span> <span class="n">session</span><span class="p">.</span>
<span class="mf">2.</span> <span class="n">Use</span> <span class="mi">2</span><span class="n">nd</span> <span class="n">session</span> <span class="ow">and</span> <span class="k">if</span> <span class="n">it</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">expired</span><span class="p">,</span> <span class="n">it</span> <span class="n">could</span> <span class="n">be</span> <span class="n">an</span> <span class="n">issue</span> <span class="k">if</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">insufficient</span> <span class="n">session</span> <span class="n">expiration</span> <span class="n">issue</span><span class="p">.</span>
<span class="mf">3.</span> <span class="n">In</span> <span class="n">this</span> <span class="n">scenario</span> <span class="k">if</span> <span class="n">an</span> <span class="n">attacker</span> <span class="n">hijacks</span> <span class="n">an</span> <span class="n">active</span> <span class="n">session</span> <span class="n">before</span> <span class="mi">2</span><span class="n">FA</span><span class="p">,</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">possible</span> <span class="n">to</span> <span class="n">carry</span> <span class="n">out</span> <span class="nb">all</span> <span class="n">functions</span> <span class="n">without</span> <span class="n">a</span> <span class="n">need</span> <span class="k">for</span> <span class="mi">2</span><span class="n">FA</span>
</code></pre></div></div>

<h3 id="references-1">References</h3>

<ul>
  <li>https://bugcrowd.com/disclosures/4147cfbb-a808-4504-9b4f-2a8b68e17d62/old-session-does-not-expire-after-setup-2fa</li>
</ul>

<h2 id="enable-2fa-without-verifying-the-email--p3-">Enable 2FA without verifying the email [ P3 ]</h2>

<h3 id="steps-4">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">The</span> <span class="n">attacker</span> <span class="n">signs</span> <span class="n">up</span> <span class="k">with</span> <span class="n">victim</span><span class="sh">'</span><span class="s">s email (Email verification will be sent to victim</span><span class="sh">'</span><span class="n">s</span> <span class="n">email</span><span class="p">).</span> 
<span class="mf">2.</span> <span class="n">Attacker</span> <span class="ow">is</span> <span class="n">able</span> <span class="n">to</span> <span class="n">log</span> <span class="ow">in</span> <span class="n">without</span> <span class="n">verifying</span> <span class="n">the</span> <span class="n">email</span><span class="p">.</span> 
<span class="mf">3.</span> <span class="n">Attacker</span> <span class="n">adds</span> <span class="mi">2</span><span class="n">FA</span><span class="p">.</span> 
<span class="mf">4.</span> <span class="n">the</span> <span class="n">victim</span> <span class="n">can</span><span class="sh">'</span><span class="s">t register an account with victim email. If the victim reset the password, the password will change, but the victim can</span><span class="sh">'</span><span class="n">t</span> <span class="n">login</span> <span class="n">because</span> <span class="mi">2</span><span class="n">FA</span><span class="p">.</span>
</code></pre></div></div>

<h3 id="references-2">References</h3>

<ul>
  <li>https://hackerone.com/reports/649533</li>
</ul>

<h2 id="idor-leads-to-ato--p2-p3-">IDOR Leads To ATO [ P2, P3 ]</h2>

<h3 id="steps-5">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">As</span> <span class="n">a</span> <span class="n">user1</span><span class="p">,</span> <span class="n">register</span><span class="p">,</span> <span class="n">skip</span> <span class="mi">2</span><span class="n">FA</span><span class="p">,</span> <span class="n">copy</span> <span class="n">the</span> <span class="n">ID</span><span class="p">.</span>
<span class="mf">2.</span> <span class="n">Register</span> <span class="n">an</span> <span class="n">account</span> <span class="n">user2</span><span class="p">,</span> <span class="n">register</span><span class="p">,</span> <span class="n">perform</span> <span class="n">a</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">request</span> <span class="n">but</span> <span class="k">with</span> <span class="n">ID</span> <span class="k">from</span> <span class="n">user1</span><span class="p">.</span>
<span class="mf">3.</span> <span class="mi">2</span><span class="n">FA</span> <span class="ow">is</span> <span class="n">enabled</span> <span class="n">now</span> <span class="n">on</span> <span class="n">the</span> <span class="n">account</span> <span class="n">user1</span><span class="err">!</span>
<span class="mf">4.</span> <span class="n">Perform</span> <span class="n">a</span> <span class="n">request</span> <span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="mi">2</span><span class="n">fa</span><span class="o">/</span><span class="n">verify</span> <span class="k">with</span> <span class="n">valid</span> <span class="n">code</span> <span class="ow">and</span> <span class="n">ID</span> <span class="n">of</span> <span class="n">user1</span><span class="p">.</span>
</code></pre></div></div>

<h3 id="references-3">References</h3>

<ul>
  <li>https://hackerone.com/reports/810880</li>
</ul>

<h1 id="2-2fa-bypass">2. 2FA Bypass</h1>

<h2 id="2fa-code-is-not-updated-after-new-code-is-requested--p5-">2FA Code is Not Updated After New Code is Requested [ P5 ]</h2>

<p>Using sms, requesting multiple 2FA codes (without using them) results in the same code being sent</p>

<h3 id="steps-6">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">Try</span> <span class="n">Login</span> <span class="n">to</span> <span class="n">your</span> <span class="n">account</span> 
<span class="mf">2.</span> <span class="n">In</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">Request</span> <span class="n">resend</span> <span class="n">the</span> <span class="n">code</span> 
<span class="mf">3.</span> <span class="n">If</span> <span class="n">the</span> <span class="n">old</span> <span class="ow">and</span> <span class="n">new</span> <span class="n">code</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">same</span> <span class="n">then</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">an</span> <span class="n">issue</span> 
<span class="n">Impact</span><span class="p">:</span> <span class="n">code</span> <span class="n">that</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">updated</span> <span class="n">after</span> <span class="n">a</span> <span class="n">request</span> <span class="n">new</span> <span class="n">one</span> <span class="n">makes</span> <span class="n">it</span> <span class="n">easier</span> <span class="k">for</span> <span class="n">a</span> <span class="n">hacker</span> <span class="n">to</span> <span class="n">brute</span> <span class="n">force</span> <span class="ow">or</span> <span class="n">guess</span> <span class="n">the</span> <span class="n">code</span>
</code></pre></div></div>

<h3 id="resources">Resources</h3>

<ul>
  <li>https://github.com/bugcrowd/vulnerability-rating-taxonomy/issues/289</li>
</ul>

<h2 id="old-2fa-code-is-not-invalidated-after-new-code-is-generated--p5-p4-">Old 2FA Code is Not Invalidated After New Code is Generated [ P5, P4 ]</h2>

<ul>
  <li>A new 2FA code is generated for the user.</li>
  <li>The old 2FA code from a previous generation is not immediately marked as invalid or revoked.</li>
  <li>An attacker could potentially use the old 2FA code, even though a new one has been generated.</li>
</ul>

<h3 id="steps-7">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">Try</span> <span class="n">Login</span> <span class="n">to</span> <span class="n">your</span> <span class="n">account</span> 
<span class="mf">2.</span> <span class="ow">in</span> <span class="mi">2</span><span class="n">fa</span> <span class="n">page</span> <span class="n">request</span> <span class="n">a</span> <span class="n">new</span> <span class="n">code</span> 
<span class="mf">3.</span> <span class="n">Enter</span> <span class="n">the</span> <span class="n">Old</span> <span class="n">code</span> 
<span class="o">---------</span>
<span class="mf">1.</span> <span class="n">Request</span> <span class="n">a</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">code</span> <span class="ow">and</span> <span class="n">use</span> <span class="n">it</span> 
<span class="mf">2.</span> <span class="n">Now</span><span class="p">,</span> <span class="n">Re</span><span class="o">-</span><span class="n">use</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">code</span> <span class="ow">and</span> <span class="k">if</span> <span class="n">it</span> <span class="ow">is</span> <span class="n">used</span> <span class="n">successfully</span> <span class="n">that</span><span class="sh">'</span><span class="s">s an issue.
3. Also, try to re-use the previously used code after long time duration say 1 day or more. That will be an potential issue as 1 day is enough duration to crack and guess a 6-digit 2FA code.
-------------------
1. authenticator generate code every 30 sec
2. wait 30 sec then use the code 
-----------------------------------------------------------------
1. Remove authenticator from your account and generate New 2FA secret and attach it with authenticator 
2. Use codes generated by old 2fa secret with authenticator
</span></code></pre></div></div>

<h3 id="references-4">References</h3>

<ul>
  <li>https://github.com/bugcrowd/vulnerability-rating-taxonomy/issues/289</li>
  <li>https://hackerone.com/reports/695041</li>
  <li>https://gitlab.com/gitlab-org/gitlab/-/issues/121666</li>
</ul>

<h2 id="2fa-code-leakage-in-response--p3-">2FA Code Leakage in Response [ P3 ]</h2>

<h3 id="steps-8">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">At</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">Code</span> <span class="n">Triggering</span> <span class="n">Request</span><span class="p">,</span> <span class="n">such</span> <span class="k">as</span> <span class="n">Send</span> <span class="n">OTP</span> <span class="n">functionality</span><span class="p">,</span> <span class="n">capture</span> <span class="n">the</span> <span class="n">Request</span><span class="p">.</span>
<span class="mf">2.</span> <span class="n">See</span> <span class="n">the</span> <span class="n">Response</span> <span class="n">to</span> <span class="n">this</span> <span class="n">request</span> <span class="ow">and</span> <span class="n">analyze</span> <span class="k">if</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">Code</span> <span class="ow">is</span> <span class="n">leaked</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">response</span> <span class="n">somewhere</span><span class="p">.</span>
</code></pre></div></div>

<h3 id="references-5">References</h3>

<ul>
  <li>https://hackerone.com/reports/1276373</li>
</ul>

<h2 id="lack-of-brute-force-protection--p4-">Lack of Brute-Force Protection [ P4 ]</h2>

<p>This involves all sort of issues which comes under security misconfiguration such as lack of rate limit, no brute-force protection, etc.</p>

<h3 id="steps-9">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">Request</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">code</span> <span class="ow">and</span> <span class="n">capture</span> <span class="n">this</span> <span class="n">request</span><span class="p">.</span>
<span class="mf">2.</span> <span class="n">Repeat</span> <span class="n">this</span> <span class="n">request</span> <span class="k">for</span> <span class="mi">100</span><span class="o">-</span><span class="mi">200</span> <span class="n">times</span> <span class="ow">and</span> <span class="k">if</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">no</span> <span class="n">limitation</span> <span class="nb">set</span><span class="p">,</span> <span class="n">that</span><span class="sh">'</span><span class="s">s a rate limit issue.
3. At 2FA Code Verification page, try to brute-force for valid 2FA and see if there is any success.
4. You can also try to initiate, requesting OTPs at one side and brute-forcing at another side. Somewhere the OTP will match in middle and may give you a quick result
5. try bypass rate limit protection by changing the subdomain in host header
-----------
1. go to the 2FA page
2. Click on the </span><span class="sh">"</span><span class="s">Resend code</span><span class="sh">"</span><span class="s"> Button
3. Capture this request 
4. Resend it 50 times
Impact: You won</span><span class="sh">'</span><span class="n">t</span> <span class="n">be</span> <span class="n">able</span> <span class="n">to</span> <span class="n">bypass</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">but</span> <span class="n">you</span> <span class="n">will</span> <span class="n">be</span> <span class="n">able</span> <span class="n">to</span> <span class="n">waste</span> <span class="n">the</span> <span class="n">company</span><span class="sh">'</span><span class="s">s money.
----------
# no rate limit after reset password 
1. A user sends a password reset message to user</span><span class="sh">'</span><span class="n">s</span> <span class="n">registered</span> <span class="n">email</span><span class="p">.</span>
<span class="mf">2.</span> <span class="n">Go</span> <span class="n">to</span> <span class="sh">"</span><span class="s">Password Reset</span><span class="sh">"</span> <span class="n">page</span> <span class="k">from</span> <span class="c1">#1's message.
</span><span class="mf">3.</span> <span class="n">Set</span> <span class="n">a</span> <span class="n">new</span> <span class="n">password</span> <span class="ow">and</span> <span class="n">Brute</span> <span class="n">force</span> <span class="n">two</span><span class="o">-</span><span class="n">factor</span> <span class="n">auth</span> <span class="n">code</span>
</code></pre></div></div>

<h3 id="references-6">References</h3>

<ul>
  <li>https://hackerone.com/reports/1060518</li>
  <li>https://hackerone.com/reports/121696</li>
</ul>

<h2 id="missing-2fa-code-integrity-validation--p3-">Missing 2FA Code Integrity Validation [ P3 ]</h2>

<h3 id="steps-10">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">Request</span> <span class="n">a</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">code</span> <span class="k">from</span> <span class="n">Attacker</span> <span class="n">Account</span><span class="p">.</span>
<span class="mf">2.</span> <span class="n">Use</span> <span class="n">this</span> <span class="n">valid</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">code</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">victim</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">Request</span> <span class="ow">and</span> <span class="n">see</span> <span class="k">if</span> <span class="n">it</span> <span class="n">bypasses</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">Protection</span><span class="p">.</span> 
<span class="mf">1.</span> <span class="n">Check</span> <span class="k">if</span> <span class="n">you</span> <span class="n">can</span> <span class="n">get</span> <span class="n">the</span> <span class="n">token</span> <span class="k">from</span> <span class="n">your</span> <span class="n">account</span> <span class="ow">and</span> <span class="k">try</span> <span class="n">to</span> <span class="n">use</span> <span class="n">it</span> <span class="n">to</span> <span class="n">bypass</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">different</span> <span class="n">account</span><span class="p">.</span>
</code></pre></div></div>

<h2 id="bypass-2fa-with-null-or-000000-or-blanc---p3-">Bypass 2FA with null or 000000 or Blanc  [ P3 ]</h2>

<h3 id="steps-11">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">log</span> <span class="ow">in</span> <span class="n">to</span> <span class="n">your</span> <span class="n">account</span>
<span class="mf">2.</span> <span class="n">Enable</span> <span class="mi">2</span><span class="n">FA</span>
<span class="mf">3.</span> <span class="n">Logout</span>
<span class="mf">4.</span> <span class="n">Login</span> <span class="n">again</span> <span class="ow">and</span> <span class="n">notice</span> <span class="n">OTP</span> <span class="ow">is</span> <span class="n">asked</span>
<span class="mf">5.</span> <span class="n">Now</span> <span class="n">using</span> <span class="n">the</span> <span class="n">Burp</span> <span class="n">suite</span> <span class="n">intercept</span> <span class="n">the</span> <span class="n">POST</span> <span class="n">request</span> <span class="n">by</span>   <span class="n">sending</span> <span class="n">the</span> <span class="n">incorrect</span> <span class="n">code</span><span class="p">.</span> <span class="p">[</span><span class="n">Do</span> <span class="ow">not</span> <span class="n">forward</span><span class="p">]</span>
<span class="mf">6.</span> <span class="n">Before</span> <span class="n">forwarding</span> <span class="n">the</span> <span class="n">request</span> <span class="n">to</span> <span class="n">the</span> <span class="n">server</span><span class="p">,</span> <span class="n">remove</span> <span class="n">the</span> <span class="n">code</span> <span class="ow">and</span> <span class="n">forward</span> <span class="o">|</span> <span class="n">OR</span> <span class="n">Enter</span> <span class="n">the</span> <span class="n">code</span> <span class="mi">000000</span> <span class="ow">or</span> <span class="n">null</span> <span class="n">to</span> <span class="n">bypass</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">protection</span><span class="p">.</span>
<span class="mf">7.</span> <span class="n">Turnoff</span> <span class="n">Intercept</span> <span class="ow">and</span> <span class="n">notice</span> <span class="n">that</span> <span class="n">your</span> <span class="n">login</span> <span class="n">request</span> <span class="n">has</span> <span class="n">been</span> <span class="n">fulfilled</span>
</code></pre></div></div>

<h3 id="references-7">References</h3>

<ul>
  <li>https://hackerone.com/reports/897385</li>
  <li>https://hackerone.com/reports/897385</li>
</ul>

<h2 id="2fa-referrer-check-bypass--direct-request--p2-p3-">2FA Referrer Check Bypass | Direct Request [ P2, P3 ]</h2>

<h3 id="steps-12">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">Directly</span> <span class="n">Navigate</span> <span class="n">to</span> <span class="n">the</span> <span class="n">page</span> <span class="n">which</span> <span class="n">comes</span> <span class="n">after</span> <span class="mi">2</span><span class="n">FA</span> <span class="ow">or</span> <span class="nb">any</span> <span class="n">other</span> <span class="n">authenticated</span> <span class="n">page</span> <span class="n">of</span> <span class="n">the</span> <span class="n">application</span><span class="p">.</span> 
<span class="mf">2.</span> <span class="n">See</span> <span class="k">if</span> <span class="n">this</span> <span class="n">bypasses</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">restrictions</span><span class="p">.</span> 
<span class="mf">3.</span> <span class="k">try</span> <span class="n">to</span> <span class="n">change</span> <span class="n">the</span> <span class="n">Referrer</span> <span class="n">header</span> <span class="k">as</span> <span class="k">if</span> <span class="n">you</span> <span class="n">came</span> <span class="k">from</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">page</span><span class="p">.</span>
</code></pre></div></div>

<h2 id="misconfiguration-of-session-permissions--p4-p3-">Misconfiguration of Session permissions [ P4, P3 ]</h2>

<h3 id="steps-13">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">Using</span> <span class="n">the</span> <span class="n">same</span> <span class="n">session</span> <span class="n">start</span> <span class="n">the</span> <span class="n">flow</span> <span class="n">using</span> <span class="n">your</span> <span class="n">account</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">victim</span><span class="sh">'</span><span class="s">s account.
2. When reaching the 2FA point on both accounts.
3. complete the 2FA with your account but do not access the next part.
4. Instead of that, try to access the next step with the victim</span><span class="sh">'</span><span class="n">s</span> <span class="n">account</span> <span class="n">flow</span><span class="p">.</span>
<span class="mf">5.</span> <span class="n">If</span> <span class="n">the</span> <span class="n">back</span><span class="o">-</span><span class="n">end</span> <span class="n">only</span> <span class="nb">set</span> <span class="n">a</span> <span class="n">Boolean</span> <span class="n">inside</span> <span class="n">your</span> <span class="n">sessions</span> <span class="n">saying</span> <span class="n">that</span> <span class="n">you</span> <span class="n">have</span> <span class="n">successfully</span> <span class="n">passed</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">you</span> <span class="n">will</span> <span class="n">be</span> <span class="n">able</span> <span class="n">to</span> <span class="n">bypass</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">of</span> <span class="n">the</span> <span class="n">victim</span><span class="p">.</span>
</code></pre></div></div>

<h2 id="lack-of-rate-limit-in-the-users-account-when-logged-in--p4-">Lack of rate limit in the user’s account when logged in [ P4 ]</h2>

<h3 id="steps-14">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Sometimes</span> <span class="n">you</span> <span class="n">can</span> <span class="n">configure</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="k">for</span> <span class="n">some</span> <span class="n">actions</span> <span class="n">inside</span> <span class="n">your</span> <span class="nf">account </span><span class="p">(</span><span class="n">change</span> <span class="n">mail</span><span class="p">,</span> <span class="n">password</span><span class="p">...).</span> 

<span class="n">However</span><span class="p">,</span> <span class="n">even</span> <span class="ow">in</span> <span class="n">cases</span> <span class="n">where</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">a</span> <span class="n">rate</span> <span class="n">limit</span> <span class="n">when</span> <span class="n">you</span> <span class="n">tried</span> <span class="n">to</span> <span class="n">log</span> <span class="ow">in</span><span class="p">,</span> <span class="n">there</span> <span class="n">isn</span><span class="sh">'</span><span class="s">t any rate limit to protect actions inside the account.
</span></code></pre></div></div>

<h3 id="changing-the-2fa-mode-leads-to-bypass-the-code--p3-">Changing the 2FA mode Leads to Bypass the code [ P3 ]</h3>

<h3 id="steps-15">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">Use</span> <span class="n">burp</span> <span class="n">suite</span> <span class="ow">or</span> <span class="n">another</span> <span class="n">tool</span> <span class="n">to</span> <span class="n">intercept</span> <span class="n">the</span> <span class="n">requests</span> 
<span class="mf">2.</span> <span class="n">Turn</span> <span class="n">on</span> <span class="ow">and</span> <span class="n">configure</span> <span class="n">your</span> <span class="n">MFA</span>
<span class="mf">3.</span> <span class="n">Login</span> <span class="k">with</span> <span class="n">your</span> <span class="n">email</span> <span class="ow">and</span> <span class="n">password</span> 
<span class="mf">4.</span> <span class="n">The</span> <span class="n">page</span> <span class="n">of</span> <span class="n">MFA</span> <span class="ow">is</span> <span class="n">going</span> <span class="n">to</span> <span class="n">appear</span>
<span class="mf">5.</span> <span class="n">Enter</span> <span class="nb">any</span> <span class="n">random</span> <span class="n">number</span> 
<span class="mf">6.</span> <span class="n">when</span> <span class="n">you</span> <span class="n">press</span> <span class="n">the</span> <span class="n">button</span> <span class="sh">"</span><span class="s">sign in securely</span><span class="sh">"</span> <span class="n">intercept</span> <span class="n">the</span> <span class="n">request</span> <span class="n">POST</span> <span class="n">auth</span><span class="p">.</span><span class="n">target</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">v3</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">login</span> <span class="ow">and</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">POST</span> <span class="n">message</span> <span class="n">change</span> <span class="n">the</span> <span class="n">fields</span><span class="p">:</span> <span class="sh">"</span><span class="s">mode</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">sms</span><span class="sh">"</span> <span class="n">by</span> <span class="sh">"</span><span class="s">mode</span><span class="sh">"</span><span class="p">:</span><span class="sh">"</span><span class="s">email</span><span class="sh">"</span> <span class="sh">"</span><span class="s">secureLogin</span><span class="sh">"</span><span class="p">:</span><span class="n">true</span> <span class="n">by</span> <span class="sh">"</span><span class="s">secureLogin</span><span class="sh">"</span><span class="p">:</span><span class="n">false</span>
<span class="n">send</span> <span class="n">the</span> <span class="n">modification</span> <span class="ow">and</span> <span class="n">check</span><span class="p">,</span> <span class="n">you</span> <span class="n">are</span> <span class="ow">in</span> <span class="n">your</span> <span class="n">account</span><span class="err">!</span> <span class="n">It</span> <span class="n">was</span> <span class="ow">not</span> <span class="n">necessary</span> <span class="n">to</span> <span class="n">enter</span> <span class="n">the</span> <span class="n">phone</span> <span class="n">code</span><span class="p">.</span> 

</code></pre></div></div>

<h3 id="references-8">References</h3>

<ul>
  <li>https://hackerone.com/reports/665722</li>
</ul>

<h2 id="bypass-using-oauth--p5-">Bypass Using OAUTH [ P5 ]</h2>

<h3 id="steps-16">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Site</span><span class="p">.</span><span class="n">com</span> <span class="n">requests</span> <span class="n">Facebook</span> <span class="k">for</span> <span class="n">OAuth</span> <span class="n">token</span> <span class="o">&gt;</span> <span class="n">Facebook</span> <span class="n">verifies</span> <span class="n">user</span> <span class="n">account</span> <span class="o">&gt;</span> <span class="n">Facebook</span> <span class="n">sends</span> <span class="n">callback</span> <span class="n">code</span> <span class="o">&gt;</span> <span class="n">Site</span><span class="p">.</span><span class="n">com</span> <span class="n">logs</span> <span class="n">a</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">without</span> <span class="n">requesting</span> <span class="mi">2</span><span class="n">fa</span> <span class="n">code</span>
</code></pre></div></div>

<h3 id="references-9">References</h3>

<ul>
  <li>https://hackerone.com/reports/178293</li>
</ul>

<h2 id="random-timeout-issue-on-a-two-step-verification-endpoint--p3-">Random timeout issue on a Two-Step Verification endpoint [ P3 ]</h2>

<h3 id="steps-17">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">enter</span> <span class="mi">2</span> <span class="n">wrong</span> <span class="n">attempts</span> <span class="ow">in</span> <span class="n">a</span> <span class="n">short</span> <span class="n">time</span>  
<span class="n">this</span> <span class="n">may</span> <span class="n">leads</span> <span class="n">to</span> <span class="n">bypass</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">process</span>
</code></pre></div></div>

<h3 id="references-10">References</h3>

<p>https://hackerone.com/reports/1747978</p>

<h1 id="3-disable-2fa">3. Disable 2FA</h1>

<h2 id="lack-of-brute-force-protection-disable-2fa--p4-">Lack of Brute-Force Protection Disable 2FA [ P4 ]</h2>

<h3 id="steps-18">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="n">Login</span> <span class="ow">in</span> <span class="n">your</span> <span class="n">target</span>
<span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="n">Click</span> <span class="n">on</span> <span class="n">your</span> <span class="n">username</span> 
<span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">Navigate</span> <span class="n">to</span> <span class="n">Two</span><span class="o">-</span><span class="n">factor</span> <span class="n">authentication</span> <span class="o">--&gt;</span> <span class="n">Disable</span> <span class="mi">2</span><span class="n">FA</span> 
<span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="n">add</span> <span class="n">random</span> <span class="n">password</span> <span class="ow">in</span> <span class="n">Please</span> <span class="n">confirm</span> <span class="n">your</span> <span class="n">identity</span> <span class="n">to</span> <span class="n">register</span> <span class="n">a</span> <span class="n">new</span> <span class="n">Two</span><span class="o">-</span><span class="n">Factor</span> <span class="n">Authenticator</span> 
<span class="p">(</span><span class="mi">5</span><span class="p">)</span> <span class="n">Capture</span> <span class="n">the</span> <span class="n">request</span> <span class="ow">and</span> <span class="n">send</span> <span class="n">it</span> <span class="n">to</span> <span class="n">Intruder</span> <span class="k">for</span> <span class="n">fuzz</span> 
</code></pre></div></div>

<h3 id="references-11">References</h3>

<ul>
  <li>https://hackerone.com/reports/1465277</li>
</ul>

<h2 id="disable-2fa-via-csrf-leads-to-2fa-bypass--p4-">Disable 2FA via CSRF (Leads to 2FA Bypass) [ P4 ]</h2>

<h3 id="steps-19">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">Go</span> <span class="n">to</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">pandao</span><span class="p">.</span><span class="n">ru</span><span class="o">/</span><span class="n">profile</span><span class="o">/</span><span class="n">settings</span> <span class="ow">and</span> <span class="n">sign</span> <span class="n">up</span> <span class="k">for</span> <span class="n">two</span> <span class="n">accounts</span><span class="p">.</span> <span class="n">In</span> <span class="n">which</span> <span class="n">first</span> <span class="ow">is</span> <span class="n">attacker</span><span class="sh">'</span><span class="s">s account and second is Victim’s 
2. Log in to the Attackers account and capture the Disable 2FA request in the Burp suite and generate CSRF POC.
3. Save the CSRF POC file with extension .html 
4. Now log in to Victim’s account in Private Browser and fire that CSRF file. Now you can see that It disables 2FA which leads to 2FA Bypass 
-------------------
1. Capture request in burpsuite
2. Engagement tools&gt; Generate CSRF POC 
3. Pass null chars in token value so function will over-ride
4. Submit twice for overriding
5. 2FA disabled

Just add this for extra
&lt;!-- Reload page every 5 seconds. --&gt;
 &lt;body onload=</span><span class="sh">"</span><span class="s">timer = setTimeout(</span><span class="sh">'</span><span class="nf">auto_reload</span><span class="p">()</span><span class="sh">'</span><span class="s">,5000);</span><span class="sh">"</span><span class="s">&gt;
&lt;/body&gt;
&lt;/html&gt;
</span></code></pre></div></div>

<h3 id="references-12">References</h3>

<ul>
  <li>https://vbharad.medium.com/2-fa-bypass-via-csrf-attack-8f2f6a6e3871</li>
  <li>https://hackerone.com/reports/670329</li>
  <li>https://twitter.com/adityashende17/status/1241093166540849152</li>
</ul>

<h2 id="password-resetemail-check--disable-2fa--p5p4-">Password Reset/Email Check → Disable 2FA [ P5,P4 ]</h2>

<h3 id="steps-20">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">*</span> <span class="n">Create</span> <span class="n">an</span> <span class="n">Account</span> <span class="ow">and</span> <span class="n">Turn</span> <span class="n">On</span> <span class="mi">2</span><span class="n">FA</span><span class="p">.</span> 
<span class="o">*</span> <span class="n">Logout</span> <span class="k">from</span> <span class="n">that</span> <span class="n">account</span><span class="p">.</span> 
<span class="o">*</span> <span class="n">Now</span><span class="p">,</span> <span class="n">Go</span> <span class="n">to</span> <span class="n">Forget</span> <span class="n">Password</span><span class="o">-</span><span class="n">Reset</span> <span class="n">page</span><span class="p">.</span> 
<span class="o">*</span> <span class="n">Change</span> <span class="n">your</span> <span class="n">password</span><span class="p">.</span> 
<span class="o">*</span> <span class="n">Now</span> <span class="k">try</span> <span class="n">to</span> <span class="n">log</span> <span class="ow">in</span><span class="p">,</span> <span class="n">If</span> <span class="n">you</span> <span class="n">are</span> <span class="ow">not</span> <span class="n">asked</span> <span class="n">to</span> <span class="n">enter</span> <span class="n">a</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">code</span><span class="p">,</span> <span class="n">You</span> <span class="n">can</span> <span class="n">report</span><span class="p">.</span>
</code></pre></div></div>

<h3 id="references-13">References</h3>

<ul>
  <li>https://infosecwriteups.com/how-i-bypass-2fa-while-resetting-password-3f73bf665728</li>
</ul>

<h2 id="logic-bug-disable-2fa--p3-">Logic Bug Disable 2FA [ P3 ]</h2>

<h3 id="steps-21">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">Open</span> <span class="n">Your</span> <span class="n">BurpSuite</span> <span class="ow">and</span> <span class="n">Turn</span> <span class="n">on</span> <span class="n">the</span> <span class="n">intercept</span> 
<span class="mf">2.</span> <span class="n">Go</span> <span class="n">To</span> <span class="mi">2</span><span class="n">Factor</span> <span class="n">Authentication</span> <span class="n">page</span> <span class="n">click</span> <span class="n">the</span> <span class="n">red</span> <span class="n">buttons</span> <span class="sh">"</span><span class="s">Disable two factor ....</span><span class="sh">"</span> 
<span class="mf">3.</span> <span class="n">Put</span> <span class="nb">any</span> <span class="n">wrong</span> <span class="n">password</span> <span class="ow">and</span> <span class="n">copy</span> <span class="nb">all</span> <span class="n">the</span> <span class="n">header</span> 
<span class="mf">4.</span> <span class="n">Go</span> <span class="n">to</span> <span class="n">repeater</span> <span class="ow">and</span> <span class="n">make</span> <span class="n">a</span> <span class="n">POST</span> <span class="n">request</span> <span class="n">to</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">localizestaging</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">user</span><span class="o">/</span><span class="n">two</span><span class="o">-</span><span class="n">factor</span><span class="o">/</span><span class="nb">set</span> <span class="n">also</span> <span class="n">Paste</span> <span class="n">the</span> <span class="n">header</span> <span class="n">here</span><span class="p">.</span>
<span class="mf">5.</span> <span class="n">add</span> <span class="n">a</span> <span class="n">body</span> <span class="n">request</span> <span class="n">like</span> <span class="n">this</span> <span class="n">method</span><span class="o">=</span><span class="n">sms</span><span class="o">&amp;</span><span class="n">phone</span><span class="o">=%</span><span class="mi">2</span><span class="n">B62</span><span class="o">-</span><span class="n">hacker</span><span class="o">-</span><span class="n">phone</span><span class="o">-</span><span class="n">number</span> <span class="n">then</span> <span class="n">click</span> <span class="n">GO</span> 
<span class="mf">6.</span> <span class="n">Bypassed</span> <span class="err">!</span>
</code></pre></div></div>

<h3 id="references-14">References</h3>

<ul>
  <li>https://hackerone.com/reports/783258</li>
</ul>

<h2 id="backup-code-abuse--varient-">Backup Code Abuse [ Varient ]</h2>

<h3 id="steps-22">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Apply</span> <span class="n">same</span> <span class="n">techniques</span> <span class="n">used</span> <span class="n">on</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">such</span> <span class="k">as</span> <span class="n">Response</span><span class="o">/</span><span class="n">Status</span> <span class="n">Code</span> <span class="n">Manipulation</span><span class="p">,</span> <span class="n">Brute</span><span class="o">-</span><span class="n">force</span><span class="p">,</span> <span class="n">etc</span><span class="p">.</span> <span class="n">to</span> <span class="n">bypass</span> <span class="n">Backup</span> <span class="n">Codes</span> <span class="ow">and</span> <span class="n">disable</span><span class="o">/</span><span class="n">reset</span> <span class="mi">2</span><span class="n">FA</span>

<span class="n">Backup</span> <span class="n">codes</span> <span class="n">are</span> <span class="n">generated</span> <span class="n">immediately</span> <span class="n">after</span> <span class="mi">2</span><span class="n">FA</span> <span class="ow">is</span> <span class="n">enabled</span> <span class="ow">and</span> <span class="n">are</span> <span class="n">available</span> <span class="n">on</span> <span class="n">a</span> <span class="n">single</span> <span class="n">request</span><span class="p">.</span> <span class="n">After</span> <span class="n">each</span> <span class="n">subsequent</span> <span class="n">call</span> <span class="n">to</span> <span class="n">the</span> <span class="n">request</span><span class="p">,</span> <span class="n">the</span> <span class="n">codes</span> <span class="n">can</span> <span class="n">be</span> <span class="n">regenerated</span> <span class="ow">or</span> <span class="n">remain</span> <span class="nf">unchanged </span><span class="p">(</span><span class="n">static</span> <span class="n">codes</span><span class="p">).</span> 

<span class="n">If</span> <span class="n">there</span> <span class="n">are</span> <span class="n">CORS</span> <span class="n">misconfigurations</span><span class="o">/</span><span class="n">XSS</span> <span class="n">vulnerabilities</span> <span class="ow">and</span> <span class="n">other</span> <span class="n">bugs</span> <span class="n">that</span> <span class="n">allow</span> <span class="n">you</span> <span class="n">to</span> <span class="err">“</span><span class="n">pull</span><span class="err">”</span> <span class="n">backup</span> <span class="n">codes</span> <span class="k">from</span> <span class="n">the</span> <span class="n">response</span> <span class="n">request</span> <span class="n">of</span> <span class="n">the</span> <span class="n">backup</span> <span class="n">code</span> <span class="n">endpoint</span><span class="p">,</span> <span class="n">then</span> <span class="n">the</span> <span class="n">attacker</span> <span class="n">could</span> <span class="n">steal</span> <span class="n">the</span> <span class="n">codes</span> <span class="ow">and</span> <span class="n">bypass</span> <span class="mi">2</span><span class="n">FA</span> <span class="k">if</span> <span class="n">the</span> <span class="n">username</span> <span class="ow">and</span> <span class="n">password</span> <span class="n">are</span> <span class="n">known</span><span class="p">.</span>
</code></pre></div></div>

<h3 id="references-15">References</h3>

<ul>
  <li>https://hackerone.com/reports/113953</li>
  <li>https://hackerone.com/reports/100509</li>
</ul>

<h2 id="password-not-checked-when-2fa-disable--p5-p4-">Password not checked when 2FA Disable [ P5, P4 ]</h2>

<h3 id="steps-23">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">Check</span> <span class="n">when</span> <span class="n">u</span> <span class="k">try</span> <span class="n">to</span> <span class="n">disable</span> <span class="mi">2</span><span class="n">FA</span> <span class="n">there</span> <span class="ow">is</span> <span class="n">no</span> <span class="n">identity</span> <span class="n">confirmation</span> <span class="n">methods</span> <span class="n">like</span> <span class="mi">2</span><span class="n">fa</span> <span class="n">code</span> <span class="n">otr</span> <span class="n">password</span> 
<span class="o">-------------------------------------</span>

<span class="mf">1.</span> <span class="n">go</span> <span class="n">to</span> <span class="n">your</span> <span class="n">account</span> <span class="ow">and</span> <span class="n">activate</span> <span class="n">the</span> <span class="mi">2</span><span class="n">FA</span> <span class="k">from</span> <span class="o">/</span><span class="n">settings</span><span class="o">/</span><span class="n">auth</span>
<span class="mf">2.</span> <span class="n">after</span> <span class="n">activating</span> <span class="n">this</span> <span class="n">option</span> <span class="n">click</span> <span class="n">on</span> <span class="n">the</span> <span class="n">Disable</span> <span class="n">icon</span> <span class="n">beside</span> <span class="n">Two</span><span class="o">-</span><span class="n">factor</span> <span class="n">authentication</span><span class="p">.</span>
<span class="mf">3.</span> <span class="n">a</span> <span class="n">new</span> <span class="n">window</span> <span class="n">will</span> <span class="nb">open</span> <span class="n">asking</span> <span class="k">for</span> <span class="n">Authentication</span> <span class="ow">or</span> <span class="n">backup</span> <span class="n">code</span> <span class="o">-</span> <span class="n">Password</span> <span class="n">to</span> <span class="n">confirm</span> <span class="n">the</span> <span class="n">disabled</span>
<span class="mf">4.</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">first</span> <span class="n">box</span> <span class="n">enter</span> <span class="n">a</span> <span class="n">valid</span> <span class="n">Authentication</span> <span class="ow">or</span> <span class="n">backup</span> <span class="n">code</span> <span class="ow">and</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">password</span> <span class="n">filed</span> <span class="n">enter</span> <span class="nb">any</span> <span class="n">random</span><span class="o">/</span><span class="n">wrong</span> <span class="n">password</span> <span class="ow">and</span> <span class="n">click</span> <span class="n">save</span><span class="p">.</span>
<span class="mf">5.</span> <span class="n">the</span> <span class="n">option</span> <span class="n">will</span> <span class="n">be</span> <span class="n">disabled</span> <span class="n">successful</span> <span class="n">without</span> <span class="n">check</span> <span class="n">the</span> <span class="n">validation</span> <span class="n">of</span> <span class="n">the</span> <span class="n">password</span><span class="p">.</span>
</code></pre></div></div>

<h3 id="resources-1">Resources</h3>

<ul>
  <li>https://hackerone.com/reports/587910</li>
</ul>

<h2 id="clickjacking-on-2fa-disabling-page--p4-">Clickjacking on 2FA Disabling Page [ P4 ]</h2>

<h3 id="steps-24">Steps</h3>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="mf">1.</span> <span class="n">Try</span> <span class="n">to</span> <span class="n">Iframe</span> <span class="n">the</span> <span class="n">page</span> <span class="n">where</span> <span class="n">the</span> <span class="n">application</span> <span class="n">allows</span> <span class="n">a</span> <span class="n">user</span> <span class="n">to</span> <span class="n">disable</span> <span class="mi">2</span><span class="n">FA</span> 
<span class="mf">2.</span> <span class="n">If</span> <span class="n">Iframe</span> <span class="ow">is</span> <span class="n">successful</span><span class="p">,</span> <span class="k">try</span> <span class="n">to</span> <span class="n">perform</span> <span class="n">a</span> <span class="n">social</span> <span class="n">engineering</span> <span class="n">attack</span> <span class="n">to</span> <span class="n">manipulate</span> <span class="n">victim</span> <span class="n">to</span> <span class="n">fall</span> <span class="ow">in</span> <span class="n">your</span> <span class="n">trap</span><span class="p">.</span>
</code></pre></div></div>
<h1 id="mind-map">Mind-Map</h1>
<ul>
  <li>https://github.com/h0tak88r/Mind_Maps/blob/main/2FA%20Security%20Testing.xmind
    <h2 id="the-end">The End</h2>
  </li>
</ul>

<p>With this, we conclude our exploration of 2FA security. Remember, the path of cybersecurity is never-ending. Until we meet again on our next endeavor, stay committed to safeguarding the digital realm. Farewell for now!</p>
